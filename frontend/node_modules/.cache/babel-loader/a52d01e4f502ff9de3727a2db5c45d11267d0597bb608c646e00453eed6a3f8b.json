{"ast":null,"code":"var _jsxFileName = \"/Users/arthur/Documents/GitHub/docker-app/frontend/src/component/FileUpload.js\",\n  _s = $RefreshSig$();\n// src/components/FileUpload.js\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useDropzone } from 'react-dropzone';\nimport { Navigate } from 'react-router-dom';\nimport { useAuth } from './AuthContext';\nimport './FileUpload.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction FileUpload() {\n  _s();\n  const [documents, setDocuments] = useState([]);\n  const token = localStorage.getItem(\"token\");\n  const getAllDocs = async () => {\n    const response = await fetch('http://localhost:8000/api/get-all-documents', {\n      headers: {\n        'Authorization': `Bearer ${token}`\n      }\n    });\n    if (response.ok) {\n      const docs = await response.json();\n      setDocuments(docs);\n      console.log('File uploaded successfully');\n    } else {\n      console.error('Error uploading file');\n    }\n  };\n  const onDrop = useCallback(acceptedFiles => {\n    if (token === null) {\n      console.error('No authentication token');\n      return;\n    }\n    acceptedFiles.forEach(file => {\n      const data = new FormData();\n      data.append('files', file);\n      fetch('http://localhost:8000/api/upload', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: data\n      }).then(response => {\n        // Handle the response from the server\n        if (response.ok) {\n          console.log('File uploaded successfully');\n          getAllDocs();\n        } else {\n          console.error('Error uploading file');\n        }\n      });\n    });\n  }, []);\n  const deleteDocument = async id => {\n    const response = await fetch(`http://localhost:8000/api/delete-document/${id}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Bearer ${token}`\n      }\n    });\n    if (response.ok) {\n      console.log('Document deleted successfully');\n      getAllDocs();\n    } else {\n      console.error('Error deleting document');\n    }\n  };\n  useEffect(() => {\n    getAllDocs();\n  }, []);\n  const {\n    getRootProps,\n    getInputProps,\n    isDragActive\n  } = useDropzone({\n    onDrop\n  });\n  const {\n    isAuthenticated,\n    userRole\n  } = useAuth();\n  if (!isAuthenticated || !userRole === 'admin') {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ...getRootProps(),\n      className: \"dropzone\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        ...getInputProps()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), isDragActive ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Drop your file here...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Drag'n drop files here, or click to select\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"all-documents\",\n      children: documents.map(doc => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"document-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"document-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            children: doc.filename\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [doc.size, \" bytes\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => deleteDocument(doc.id),\n            children: \"Delete\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n            href: `http://localhost:8000/download/${doc.id}`,\n            target: \"_blank\",\n            rel: \"noopener noreferrer\",\n            children: \"Download\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }, this), doc.mimetype.startsWith('image/') && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"document-preview\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: `http://localhost:8000/download/${doc.id}`,\n            alt: doc.filename\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 15\n        }, this)]\n      }, doc.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(FileUpload, \"e37n+i8kuO1UX0udhDBRvB9vLW0=\", false, function () {\n  return [useDropzone, useAuth];\n});\n_c = FileUpload;\nexport default FileUpload;\nvar _c;\n$RefreshReg$(_c, \"FileUpload\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","useDropzone","Navigate","useAuth","FileUpload","documents","setDocuments","token","localStorage","getItem","getAllDocs","response","fetch","headers","ok","docs","json","console","log","error","onDrop","acceptedFiles","forEach","file","data","FormData","append","method","body","then","deleteDocument","id","getRootProps","getInputProps","isDragActive","isAuthenticated","userRole","map","doc","filename","size","mimetype","startsWith"],"sources":["/Users/arthur/Documents/GitHub/docker-app/frontend/src/component/FileUpload.js"],"sourcesContent":["// src/components/FileUpload.js\nimport React, { useCallback, useEffect, useState } from 'react';\nimport {useDropzone} from 'react-dropzone';\nimport { Navigate } from 'react-router-dom';\nimport { useAuth } from './AuthContext';\nimport './FileUpload.css';\n\nfunction FileUpload() {\n\n  const [documents, setDocuments] = useState([]);\n\n  const token = localStorage.getItem(\"token\");\n\n  const getAllDocs = async () => {\n    const response = await fetch('http://localhost:8000/api/get-all-documents', {\n        headers: {\n            'Authorization': `Bearer ${token}`\n        }\n    });\n\n    if (response.ok) {\n      const docs = await response.json();\n      setDocuments(docs);\n      console.log('File uploaded successfully');\n    } else {\n      console.error('Error uploading file');\n    }\n  };\n\n  const onDrop = useCallback((acceptedFiles) => {\n    if (token === null) {\n      console.error('No authentication token');\n      return;\n    }\n\n    acceptedFiles.forEach((file) => {\n      const data = new FormData();\n      data.append('files', file);\n\n      fetch('http://localhost:8000/api/upload', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        },\n        body: data,\n      }).then((response) => {\n        // Handle the response from the server\n        if (response.ok) {\n          console.log('File uploaded successfully');\n          getAllDocs();\n        } else {\n          console.error('Error uploading file');\n        }\n      });\n    });\n  }, []);\n\n  \n  const deleteDocument = async (id) => {\n    const response = await fetch(`http://localhost:8000/api/delete-document/${id}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Bearer ${token}`\n      }\n    });\n\n    if (response.ok) {\n      console.log('Document deleted successfully');\n      getAllDocs();\n    } else {\n      console.error('Error deleting document');\n    }\n  };\n\n  useEffect(() => {\n    getAllDocs();\n  }, []);\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({ onDrop });\n  const { isAuthenticated, userRole } = useAuth();\n  \n  if (!isAuthenticated || (!userRole ==='admin')) {\n    return <Navigate to=\"/\" />;\n  }\n\n  return (\n    <div className='container'>\n      <div {...getRootProps()} className='dropzone' >\n        <input {...getInputProps()} />\n        {\n          isDragActive ?\n            <p>Drop your file here...</p> :\n            <p>Drag'n drop files here, or click to select</p>\n        }\n      </div>\n      <div className='all-documents'>\n        {documents.map(doc => (\n          <div key={doc.id} className='document-item'>\n            <div className='document-info'>\n              <h2>{doc.filename}</h2>\n              <p>{doc.size} bytes</p>\n              <button onClick={() => deleteDocument(doc.id)}>Delete</button>\n              <a href={`http://localhost:8000/download/${doc.id}`} target=\"_blank\" rel=\"noopener noreferrer\">Download</a>\n            </div>\n            {doc.mimetype.startsWith('image/') && (\n              <div className='document-preview'>\n                <img src={`http://localhost:8000/download/${doc.id}`} alt={doc.filename} />\n              </div>\n            )}\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default FileUpload;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}